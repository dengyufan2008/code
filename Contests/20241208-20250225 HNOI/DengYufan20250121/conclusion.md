# 20250121 总结

## T1(mo) [推式子]

期望:100 实际:100 难度:1 用时:1h

注意分类讨论的全面性. 如 $s$ 在区间 $[l, r]$ 内与不在区间内, $x=1$ 与 $x \neq 1$.

## T2(frog) [随机游走]

期望:100 实际:100 难度:2 用时:1h

当带取模的题目中需要进行形如 ``a -= b * c`` 的操作时, 正确的写法应当是 ``a = (a - b * c) % kMod``, 即使可能会使 $a$ 变为负数, 并在输出时使用 ``(ans + kMod) % kMod``. 几种不优的写法为: 在式子的末尾加上一个 ``kMod * kMod`` (有可能爆值域且慢), 或对于可能变为负数的变量在调用时使用 ``( + kMod) % kMod`` (有可能找不全这样的变量且慢), 或在取模后立马 ``( + kMod) % kMod`` (慢).

对于一类 $f_i = af_{i-1}+bf_{i+1} (1 \le i < n)$, 其中 $f_0$ 与 $f_n$ 给定的递推式, 可设 $f_i = s_if_{i+1}+t_i$, 从小到大递推 $s_i$ 与 $t_i$ 再从大到小还原 $f_i$ 即可. 特别地, 当 $f_0 = 0$ 时有 $t_i = 0$.

## T3(hod) [半平面] [扫描线] [操作分块] [线段树分治] [标记回收法] [[最优范围修改查询](https://www.luogu.com.cn/article/n503cwfy)]

期望:50 实际:50 难度:5 用时:2h

平面几何中要注意 **平行线** (在做半平面交时极其致命) / 三点共线 / 两线重合 的问题.

对于一类对一个区间中的集合的交进行操作的题目, 可以进行扫描线, 维护每个元素最大的不在里面的集合编号, 每次将集合外的元素赋为当前集合的编号, 操作时在 $r$ 考虑所有值 $< l$ 的元素.

对于一类 $O(m)$ 个范围操作 (如半平面加或矩形加) 会将元素 (在上例中为一个可能被查询到的坐标) 划分为 $O(m^2)$ 或更多个等价类 (以平方为例) 的问题, 若总的元素个数为 $O(n)$, 且 $m$ 远大于 $\sqrt n$, 则考虑将这些范围操作按 $\sqrt n$ 的块长分块, 则此时块内 $O(m^2)$ 个等价类是可以接受的, 其至多不超过 $O(n)$.

分块后, 对于上述的问题, 一般的解决办法为使用线段树分治, 递归时将另一边的区间内的范围操作删去, 即合并若干等价类, 回溯时再撤销这些合并等价类的操作, 在叶子上对于需要操作的 $O(1)$ 个等价类打标记.

事实上等价类的合并关系可以看成一棵森林, 则相当于每次对合并若干个根, 某个根打标记, 删除根并分裂成若干棵树, 下传标记. 容易发现此时满足给一个点打标记时祖先都没有标记 (毕竟没有祖先), 则每次打标记后将子树内的标记清空 (或言回收, 名字的来历), 在新增标记或删除标记时维护需要维护的东西即可.

## 结算

本场有较多实现上的失误, 均在上文中有体现.

对于交互题的框架并不熟练, 在调整交互库与接口上花费了约 0.5h, 并使用了一些帮助.
