# 多项式快速幂

给定 $k$ 项的多项式 $F$ 和 $m$, 求 $G = F^m$ 的前 $n$ 项系数, 对 $10^9 + 7$ 取模.

$1 \le n \le 5 \times 10^6$, $1 \le m \le 10^{18}$, $1 \le k \le 5$

---

两边求导,
$$G' = mF^{m-1}F'$$

同乘 $F$,
$$G'F = mGF'$$

取第 $n$ 项系数
$$\sum_{i=0}^{k-1} (n-i+1)g_{n-i+1}f_i = m \sum_{i=0}^{k-1} ig_{n-i+1}f_i$$

$$\sum_{i=0}^{k-1} (mi+i-n-1)g_{n-i+1}f_i = 0$$

$$\sum_{i=1}^{k-1} (mi+i-n-1)g_{n-i+1}f_i = (n+1)g_{n+1}f_0$$

$$g_{n+1} = \frac{\sum_{i=1}^{k-1} (mi+i-n-1)g_{n-i+1}f_i}{(n+1)f_0}$$

特别地, $g_0 = f_0^m$, 其余项均可递推得到.

$O(nk)$.
